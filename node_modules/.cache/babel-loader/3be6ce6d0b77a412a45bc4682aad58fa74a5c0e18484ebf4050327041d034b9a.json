{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u0410\\u0440\\u0442\\u0451\\u043C\\\\Documents\\\\coding\\\\Pulse\\\\frontend\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport './styles/App.css';\nimport ChatScreen from './components/ChatScreen';\nimport SavedMessagesScreen from './components/SavedMessagesScreen';\nimport TelegramLoginButton from './components/TelegramLoginButton';\nimport StatusBar from './components/StatusBar';\nimport { registerUser, getUserStatus } from './services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [status, setStatus] = useState({\n    daysLeft: 0,\n    tokensLeft: 0,\n    limitReached: false\n  });\n  useEffect(() => {\n    var _window$Telegram;\n    // Check if Telegram WebApp is available\n    const tg = (_window$Telegram = window.Telegram) === null || _window$Telegram === void 0 ? void 0 : _window$Telegram.WebApp;\n    if (tg) {\n      var _tg$initDataUnsafe, _tg$initDataUnsafe$us, _tg$initDataUnsafe2, _tg$initDataUnsafe2$u;\n      // Initialize Telegram WebApp\n      tg.expand();\n      tg.ready();\n\n      // Check if user is already registered\n      const initData = tg.initData;\n      const telegramId = (_tg$initDataUnsafe = tg.initDataUnsafe) === null || _tg$initDataUnsafe === void 0 ? void 0 : (_tg$initDataUnsafe$us = _tg$initDataUnsafe.user) === null || _tg$initDataUnsafe$us === void 0 ? void 0 : _tg$initDataUnsafe$us.id;\n      const username = ((_tg$initDataUnsafe2 = tg.initDataUnsafe) === null || _tg$initDataUnsafe2 === void 0 ? void 0 : (_tg$initDataUnsafe2$u = _tg$initDataUnsafe2.user) === null || _tg$initDataUnsafe2$u === void 0 ? void 0 : _tg$initDataUnsafe2$u.username) || '';\n      if (telegramId) {\n        registerUser(telegramId, username).then(response => {\n          setUser(response.user);\n          // After registration, get user status\n          return getUserStatus(telegramId);\n        }).then(statusData => {\n          setStatus({\n            daysLeft: statusData.days_left || 0,\n            tokensLeft: statusData.tokens_left || 0,\n            limitReached: statusData.limit_reached || false\n          });\n          setLoading(false);\n        }).catch(error => {\n          console.error('Error during initialization:', error);\n          setLoading(false);\n        });\n      } else {\n        setLoading(false);\n      }\n    } else {\n      // Not running inside Telegram WebApp\n      setLoading(false);\n    }\n  }, []);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 12\n    }, this);\n  }\n\n  // If no user, show login\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\u0418\\u0418, \\u043A\\u043E\\u0442\\u043E\\u0440\\u044B\\u0439 \\u043D\\u0435 \\u0434\\u0430\\u0441\\u0442 \\u0441\\u0434\\u0430\\u0442\\u044C\\u0441\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0443\\u0439\\u0442\\u0435\\u0441\\u044C \\u0447\\u0435\\u0440\\u0435\\u0437 Telegram\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TelegramLoginButton, {\n          onAuth: userData => {\n            registerUser(userData.id, userData.username).then(response => setUser(response.user));\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: /*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(StatusBar, {\n        daysLeft: status.daysLeft,\n        tokensLeft: status.tokensLeft,\n        limitReached: status.limitReached\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Routes, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/\",\n          element: /*#__PURE__*/_jsxDEV(ChatScreen, {\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 36\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/saved\",\n          element: /*#__PURE__*/_jsxDEV(SavedMessagesScreen, {\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 41\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"*\",\n          element: /*#__PURE__*/_jsxDEV(Navigate, {\n            to: \"/\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 36\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"I1M21V1Ue9xeiNjZe/73kU/s59Q=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","BrowserRouter","Router","Routes","Route","Navigate","ChatScreen","SavedMessagesScreen","TelegramLoginButton","StatusBar","registerUser","getUserStatus","jsxDEV","_jsxDEV","App","_s","user","setUser","loading","setLoading","status","setStatus","daysLeft","tokensLeft","limitReached","_window$Telegram","tg","window","Telegram","WebApp","_tg$initDataUnsafe","_tg$initDataUnsafe$us","_tg$initDataUnsafe2","_tg$initDataUnsafe2$u","expand","ready","initData","telegramId","initDataUnsafe","id","username","then","response","statusData","days_left","tokens_left","limit_reached","catch","error","console","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onAuth","userData","path","element","to","_c","$RefreshReg$"],"sources":["C:/Users/Артём/Documents/coding/Pulse/frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport './styles/App.css';\nimport ChatScreen from './components/ChatScreen';\nimport SavedMessagesScreen from './components/SavedMessagesScreen';\nimport TelegramLoginButton from './components/TelegramLoginButton';\nimport StatusBar from './components/StatusBar';\nimport { registerUser, getUserStatus } from './services/api';\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [status, setStatus] = useState({\n    daysLeft: 0,\n    tokensLeft: 0,\n    limitReached: false\n  });\n\n  useEffect(() => {\n    // Check if Telegram WebApp is available\n    const tg = window.Telegram?.WebApp;\n    if (tg) {\n      // Initialize Telegram WebApp\n      tg.expand();\n      tg.ready();\n\n      // Check if user is already registered\n      const initData = tg.initData;\n      const telegramId = tg.initDataUnsafe?.user?.id;\n      const username = tg.initDataUnsafe?.user?.username || '';\n\n      if (telegramId) {\n        registerUser(telegramId, username)\n          .then(response => {\n            setUser(response.user);\n            // After registration, get user status\n            return getUserStatus(telegramId);\n          })\n          .then(statusData => {\n            setStatus({\n              daysLeft: statusData.days_left || 0,\n              tokensLeft: statusData.tokens_left || 0,\n              limitReached: statusData.limit_reached || false\n            });\n            setLoading(false);\n          })\n          .catch(error => {\n            console.error('Error during initialization:', error);\n            setLoading(false);\n          });\n      } else {\n        setLoading(false);\n      }\n    } else {\n      // Not running inside Telegram WebApp\n      setLoading(false);\n    }\n  }, []);\n\n  if (loading) {\n    return <div className=\"loading\">Загрузка...</div>;\n  }\n\n  // If no user, show login\n  if (!user) {\n    return (\n      <div className=\"app\">\n        <div className=\"login-container\">\n          <h1>ИИ, который не даст сдаться</h1>\n          <p>Пожалуйста, авторизуйтесь через Telegram</p>\n          <TelegramLoginButton onAuth={userData => {\n            registerUser(userData.id, userData.username)\n              .then(response => setUser(response.user));\n          }} />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"app\">\n      <Router>\n        <StatusBar \n          daysLeft={status.daysLeft} \n          tokensLeft={status.tokensLeft} \n          limitReached={status.limitReached} \n        />\n        <Routes>\n          <Route path=\"/\" element={<ChatScreen user={user} />} />\n          <Route path=\"/saved\" element={<SavedMessagesScreen user={user} />} />\n          <Route path=\"*\" element={<Navigate to=\"/\" />} />\n        </Routes>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}